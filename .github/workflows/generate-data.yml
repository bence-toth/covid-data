name: Generate data

on:
  pull_request:
    types: [labeled]
  schedule:
    cron:  '0 8 * * *'
jobs:
  update-data:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - uses: actions/setup-node@v1
        with:
          node-version: '12.x'
      - name: Generate data
        run: |
          npm install
          npm run generate
      - name: Create Pull Request
        uses: peter-evans/create-pull-request@v3
        with:
          token: ${{ secrets.PERSONAL_ACCESS_TOKEN }}
          commit-message: Update dependencies
          title: Update dependencies
          body: |
            Updated COVID-19 data with most recent numbers

            Auto-generated by GitHub Actions
          branch: new-data
          base: master
